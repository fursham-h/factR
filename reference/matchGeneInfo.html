<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Match gene metadata from query GTF to a reference GTF — matchGeneInfo • factR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Match gene metadata from query GTF to a reference GTF — matchGeneInfo" />
<meta property="og:description" content="`matchGeneInfo()` matches and corrects Gene IDs from a 
query GTF object to a reference GTF" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">factR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/factR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Match gene metadata from query GTF to a reference GTF</h1>
    
    <div class="hidden name"><code>matchGeneInfo.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>`matchGeneInfo()` matches and corrects Gene IDs from a 
query GTF object to a reference GTF</p>
    </div>

    <pre class="usage"><span class='fu'>matchGeneInfo</span><span class='op'>(</span><span class='va'>query</span>, <span class='va'>ref</span>, primary_gene_id <span class='op'>=</span> <span class='cn'>NULL</span>, secondary_gene_id <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>query</th>
      <td><p>Query GTF imported as GRanges object</p></td>
    </tr>
    <tr>
      <th>ref</th>
      <td><p>Reference GTF as GRanges object</p></td>
    </tr>
    <tr>
      <th>primary_gene_id</th>
      <td><p>Character name of the primary gene id metadata in query GTF.
Input to this argument is typically 'gene_id'</p></td>
    </tr>
    <tr>
      <th>secondary_gene_id</th>
      <td><p>Character name of the secondary gene id in query file.
Example of input to this argument is 'ref_gene_id'</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Gene_id-matched query GRanges</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The default approach to this correction relies on finding overlaps 
between transcripts in query with transcripts in reference. Using this 
method alone could result in false positive matches 
(19 percent false positives).
To improve this, users have the option to invoke two additional layers 
of matching.  
(1) Matching by ENSEMBL Gene_IDs. If both query and reference transcript 
annotations containg Ensembl-style Gene IDs, this program will try to 
match both IDs in a less stringent manner. This correction can be invoked
by providing the 'primary_gene_id' argument</p>
<p>(2) Matching by secondary Gene_IDs. Depending on the transcript assembly 
program, GTF/GFF3 annotations may contain additional comments on the
transcript information. This may include a distinct secondary Gene ID 
annotation that potentially matches with the reference. To invoke this 
correction, provide 'primary_gene_id' and 'secondary_gene_id' arguments. 
To determine if your transcript assembly contain possible secondary 
Gene IDs, import query GTF file using `importGTF()` and check its metadata
columns</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Fursham Hamid</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## ---------------------------------------------------------------------</span>
<span class='co'>## EXAMPLE USING SAMPLE DATASET</span>
<span class='co'>## ---------------------------------------------------------------------</span>
<span class='co'># Load datasets</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>chrom_matched_query_gtf</span>, <span class='va'>ref_gtf</span><span class='op'>)</span>

<span class='co'># Run matching function</span>
<span class='fu'>matchGeneInfo</span><span class='op'>(</span><span class='va'>chrom_matched_query_gtf</span>, <span class='va'>ref_gtf</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Number of mismatched gene_ids found: 1</span></div><div class='output co'>#&gt; <span class='message'>---&gt; Attempting to match gene_ids by finding overlapping coordinates...</span></div><div class='output co'>#&gt; <span class='message'>---&gt; 1 gene_id matched</span></div><div class='output co'>#&gt; <span class='message'>Total gene_ids corrected: 1</span></div><div class='output co'>#&gt; <span class='message'>Remaining number of mismatched gene_ids: 0</span></div><div class='output co'>#&gt; GRanges object with 56 ranges and 6 metadata columns:
#&gt;        seqnames            ranges strand |       type transcript_id
#&gt;           &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;factor&gt;   &lt;character&gt;
#&gt;    [1]    chr10 79854427-79864432      + | transcript   transcript1
#&gt;    [2]    chr10 79854427-79854721      + | exon         transcript1
#&gt;    [3]    chr10 79856504-79856534      + | exon         transcript1
#&gt;    [4]    chr10 79858752-79858824      + | exon         transcript1
#&gt;    [5]    chr10 79858952-79859271      + | exon         transcript1
#&gt;    ...      ...               ...    ... .        ...           ...
#&gt;   [52]    chr10 79862014-79862047      + |       exon   transcript4
#&gt;   [53]    chr10 79862449-79862541      + |       exon   transcript4
#&gt;   [54]    chr10 79862653-79862869      + |       exon   transcript4
#&gt;   [55]    chr10 79862978-79863055      + |       exon   transcript4
#&gt;   [56]    chr10 79863145-79864359      + |       exon   transcript4
#&gt;                      gene_id old_gene_id match_level   gene_name
#&gt;                  &lt;character&gt; &lt;character&gt;   &lt;numeric&gt; &lt;character&gt;
#&gt;    [1] ENSMUSG00000006498.14       GeneA           4       Ptbp1
#&gt;    [2] ENSMUSG00000006498.14       GeneA           4       Ptbp1
#&gt;    [3] ENSMUSG00000006498.14       GeneA           4       Ptbp1
#&gt;    [4] ENSMUSG00000006498.14       GeneA           4       Ptbp1
#&gt;    [5] ENSMUSG00000006498.14       GeneA           4       Ptbp1
#&gt;    ...                   ...         ...         ...         ...
#&gt;   [52] ENSMUSG00000006498.14       GeneA           4       Ptbp1
#&gt;   [53] ENSMUSG00000006498.14       GeneA           4       Ptbp1
#&gt;   [54] ENSMUSG00000006498.14       GeneA           4       Ptbp1
#&gt;   [55] ENSMUSG00000006498.14       GeneA           4       Ptbp1
#&gt;   [56] ENSMUSG00000006498.14       GeneA           4       Ptbp1
#&gt;   -------
#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Fursham Hamid.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


